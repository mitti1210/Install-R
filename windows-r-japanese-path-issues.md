# Windows7/8に関する注意点

## Windowsサポートについての注意

- Windows 7/8/8.1はRStudioとしてもMicrosoftとしてもサポート対象外です。
- サポートが終了したOSを使用するとセキュリティ上のリスクが高まります。
- 本サイトに掲載されている手順は、Windows 7/8/8.1などの旧OSではエラーが発生する可能性があります。
- 本サイトに掲載されている情報や手順の利用は、すべて自己責任で行ってください。

## Windowsサポート終了とR / RStudio 利用可否

| OSバージョン | Microsoft公式サポート終了日 | R本体の利用可否 | RStudio (Posit) 利用可否 | コメント・注意点 |
|--------------|----------------------------|-----------------|--------------------------|-------------------|
| **Windows 7** | 2020/1/14（ESU終了: 2023/1/10） | △（旧バージョンのみ可、最新Rは非保証） | ×（公式サポート外。RStudio 2022.07が事実上の最終） | ネット接続は危険。パッケージ依存関係も更新停止。 |
| **Windows 8** | 2016/1/12（8.1に移行推奨） | △（旧バージョンのみ可、最新Rは非保証） | ×（サポート外） | 8自体は短命OS。実質8.1扱いで考えるべき。 |
| **Windows 8.1** | 2023/1/10 | △（R 4.1.x 以前は動作例あり、4.2以降は非保証） | ×（サポート外） | TLSや依存DLLの問題でネット通信系パッケージに不具合出やすい。 |
| **Windows 10** | 2025/10/14（Home/Pro最終版 22H2） | ○（最新R利用可） | ○（最新RStudio利用可） | 最終版22H2以降アップデートは無し。将来的にパッケージ側が非対応化する可能性あり。 |
| **Windows 11** | 各バージョンのリリースから24か月（Enterprise/Educationは36か月） | ◎（最新R利用可） | ◎（最新RStudio利用可） | 現行推奨環境。UTF-8完全対応で日本語パス問題もほぼ解消。 |

---
## 以前のWindowsにあった日本語アカウント名によるトラブルに関するまとめ

Windows 7/8の頃、**ユーザー名やOneDriveフォルダ名に日本語（全角文字）を含むと、Rのパッケージインストール時にエラーが頻発**する問題が報告されていました。特にRStudioでは、デフォルトでユーザーフォルダ配下（ドキュメントフォルダ）にライブラリを作成するため、ユーザー名やフォルダ名が日本語だとパスを正しく認識できずインストール失敗につながったのです。最近のWindows 10/11環境ではこうしたトラブルをほとんど見かけなくなっていますが、本当に解消されたのか、また何が改善につながったのかを検証します。
以下では **(1)** 「ユーザー名が日本語の場合」と **(2)** 「OneDriveフォルダ名が日本語の場合」の2点について、問題の内容・原因、旧来の対処法、現在の状況をまとめます。

---

## 1. 日本語ユーザー名によるパッケージインストールの問題

### どういう問題だったのか
Windowsのユーザーフォルダ名（アカウント名）に漢字やひらがな等の日本語を含めていると、RやRStudioでパッケージのインストール時にエラーが発生しました。  
例: `C:\Users\日本花子\Documents\R\...` が正しく認識されず、「パスが無効」エラーになる。

### なぜそれが起きたのか
- マルチバイト文字（日本語）を含むパスへの対応不備。
- Windows 7/8時代はShift_JIS（CP932）ベースで文字コードの不整合が発生しやすかった。

### 以前の回避方法
- `R_LIBS_USER`環境変数を使って、英数字のみの別パスにライブラリを設定。
- ユーザー名を英数字のみの新しいアカウントに変更・作成。
- シンボリックリンクやレジストリ変更によるフォルダ名書き換え。

---

## 2. OneDriveフォルダ名が日本語の場合の問題

### どういう問題だったのか
- OneDriveのフォルダ名に日本語（例：「OneDrive - 会社名」「ドキュメント」）が含まれると、ライブラリ作成時にエラー。
- 特にドキュメントがOneDrive配下にリダイレクトされるWindows 10の既定動作で発生。

### なぜそれが起きたのか
- ユーザー名が英字でも、OneDriveのフォルダ名に日本語が含まれる場合がある。
- 法人向けOneDriveの組織名や既定フォルダ名に全角文字が入り、パス解釈に失敗。

### 以前の回避方法
- `.libPaths()`や`R_LIBS_USER`で英数字のみのローカルパスを指定。
- OneDriveの同期設定を変更し、日本語パスを避ける。
- フォルダ名を英語化。

### 現在の状況（Windows 10/11）
- OneDrive側の実装改善やUTF-8対応により発生頻度が大幅低下。
- 稀に残る場合も、ライブラリパス変更や同期設定変更で容易に回避可能。

---

## 3. WindowsバージョンとWinget利用の関連

- WingetはWindows 7/8では使用不可、Windows 10以降で利用可能。
- ユーザースコープインストールでは`C:\Users\<ユーザー名>\AppData\Local\...`配下にインストールされることが多く、日本語ユーザー名だと動作不良の原因になり得た。
- Windows 10以降はユーザー名が英数字のため、パス問題はほぼ解消。
- `--scope machine`オプションでシステムスコープにインストールすることでさらに安全。

---

## まとめ

- **Windows 7/8時代**  
  日本語ユーザー名や日本語フォルダパスによるRパッケージインストール不具合が頻発。  
  → 環境変数設定、英数字ユーザーへの切替などが必須。
  
- **Windows 10以降**  
  ユーザー名日本語禁止・OneDrive改善・RのUTF-8対応により、発生頻度は減った。

---


